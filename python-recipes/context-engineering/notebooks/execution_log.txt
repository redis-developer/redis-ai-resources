================================================================================
NOTEBOOK EXECUTION SCRIPT
================================================================================
Workspace root: /Users/nitin.kanukolanu/workspace/redis-ai-resources
Loading environment from: /Users/nitin.kanukolanu/workspace/redis-ai-resources/python-recipes/context-engineering/.env
‚úÖ Environment variables loaded
Notebooks to execute: 4

================================================================================
Executing: 03_memory_management_long_conversations.ipynb
================================================================================
Executing notebook...
‚úÖ Saved executed notebook with outputs

================================================================================
Executing: 01_measuring_optimizing_performance.ipynb
================================================================================
Executing notebook...
‚ùå Execution failed:
[NbConvertApp] Converting notebook /var/folders/5x/2sbds3f53fl1krk68wpww95h0000gp/T/tmpdvqzs767/01_measuring_optimizing_performance.ipynb to notebook
Traceback (most recent call last):
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/bin/jupyter-nbconvert", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/jupyter_core/application.py", line 284, in launch_instance
    super().launch_instance(argv=argv, **kwargs)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/traitlets/config/application.py", line 1075, in launch_instance
    app.start()
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 420, in start
    self.convert_notebooks()
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 597, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 563, in convert_single_notebook
    output, resources = self.export_single_notebook(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 487, in export_single_notebook
    output, resources = self.exporter.from_filename(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 201, in from_filename
    return self.from_file(f, resources=resources, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 220, in from_file
    return self.from_notebook_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/notebook.py", line 36, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 154, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 353, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/base.py", line 48, in __call__
    return self.preprocess(nb, resources)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
# Node 3: Save working memory
async def save_memory(state: AgentState) -> AgentState:
    """Save updated conversation to working memory."""
    try:
        from agent_memory_client.filters import SessionId

        # Save working memory
        await memory_client.put_working_memory(
            user_id=state.student_id,
            session_id=state.session_id,
            memory=working_memory,
            model_name="gpt-4o",
            memory=working_memory
        )

        state.context["working_memory_saved"] = True
    except Exception as e:
        state.context["working_memory_saved"] = False
        state.context["save_error"] = str(e)

    return state

print("‚úÖ Node 3: save_memory")

------------------


  [36mCell[39m[36m [39m[32mIn[16][39m[32m, line 13[39m
[31m    [39m[31mmemory=working_memory[39m
    ^
[31mSyntaxError[39m[31m:[39m keyword argument repeated: memory




================================================================================
Executing: 02_scaling_semantic_tool_selection.ipynb
================================================================================
Executing notebook...
‚ùå Execution failed:
[NbConvertApp] Converting notebook /var/folders/5x/2sbds3f53fl1krk68wpww95h0000gp/T/tmp_5_6jdnh/02_scaling_semantic_tool_selection.ipynb to notebook
Traceback (most recent call last):
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/bin/jupyter-nbconvert", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/jupyter_core/application.py", line 284, in launch_instance
    super().launch_instance(argv=argv, **kwargs)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/traitlets/config/application.py", line 1075, in launch_instance
    app.start()
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 420, in start
    self.convert_notebooks()
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 597, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 563, in convert_single_notebook
    output, resources = self.export_single_notebook(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/nbconvertapp.py", line 487, in export_single_notebook
    output, resources = self.exporter.from_filename(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 201, in from_filename
    return self.from_file(f, resources=resources, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 220, in from_file
    return self.from_notebook_node(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/notebook.py", line 36, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 154, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/exporters/exporter.py", line 353, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/base.py", line 48, in __call__
    return self.preprocess(nb, resources)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 103, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbconvert/preprocessors/execute.py", line 124, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/jupyter_core/utils/__init__.py", line 165, in wrapped
    return loop.run_until_complete(inner)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/asyncio/base_events.py", line 687, in run_until_complete
    return future.result()
           ^^^^^^^^^^^^^^^
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbclient/client.py", line 1062, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/Users/nitin.kanukolanu/.pyenv/versions/3.12.6/lib/python3.12/site-packages/nbclient/client.py", line 918, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
class CheckPrerequisitesInput(BaseModel):
    """Input schema for checking course prerequisites."""
    course_id: str = Field(description="The course ID to check prerequisites for (e.g., 'RU202')")

@tool("check_prerequisites", args_schema=CheckPrerequisitesInput)
async def check_prerequisites(course_id: str) -> str:
    """
    Check the prerequisites for a specific course.

    Use this when students ask:
    - "What are the prerequisites for RU202?"
    - "Do I need to take anything before this course?"
    - "What should I learn first?"
    - "Am I ready for this course?"

    Returns: List of prerequisite courses and recommended background knowledge.
    """
    # Simulated prerequisite data (in production, this would query a database)
    prerequisites_db = {
        "RU101": {
            "required": [],
            "recommended": ["Basic command line knowledge"],
            "description": "Introduction to Redis - no prerequisites required"
        },
        "RU202": {
            "required": ["RU101"],
            "recommended": ["Basic programming experience", "Understanding of data structures"],
            "description": "Redis Streams requires foundational Redis knowledge"
        },
        "RU203": {
            "required": ["RU101"],
            "recommended": ["RU201 or equivalent data structures knowledge"],
            "description": "Querying, Indexing, and Full-Text Search"
        },
        "RU301": {
            "required": ["RU101", "RU201"],
            "recommended": ["Experience with time-series data"],
            "description": "Redis Time Series requires solid Redis foundation"
        },
        "RU501": {
            "required": ["RU101", "RU201"],
            "recommended": ["Python programming", "Basic ML concepts"],
            "description": "Machine Learning with Redis requires programming skills"
        }
    }

    course_id_upper = course_id.upper()

    if course_id_upper not in prerequisites_db:
        return f"Course {course_id} not found. Available courses: {', '.join(prerequisites_db.keys())}"

    prereqs = prerequisites_db[course_id_upper]

    output = []
    output.append(f"üìã Prerequisites for {course_id_upper}:")
    output.append(f"\n{prereqs['description']}\n")

    if prereqs['required']:
        output.append("‚úÖ Required Courses:")
        for req in prereqs['required']:
            output.append(f"   ‚Ä¢ {req}")
    else:
        output.append("‚úÖ No required prerequisites")

    if prereqs['recommended']:
        output.append("\nüí° Recommended Background:")
        for rec in prereqs['recommended']:
            output.append(f"   ‚Ä¢ {rec}")

    return "\n".join(output)

print("‚úÖ New Tool 1: check_prerequisites")
print("   Use case: Help students understand course requirements")

------------------

----- stderr -----
/var/folders/5x/2sbds3f53fl1krk68wpww95h0000gp/T/ipykernel_64171/1016242982.py:5: LangChainDeprecationWarning: The method `BaseTool.__call__` was deprecated in langchain-core 0.1.47 and will be removed in 1.0. Use :meth:`~invoke` instead.
  @tool("check_prerequisites", args_schema=CheckPrerequisitesInput)
------------------

[31m---------------------------------------------------------------------------[39m
[31mTypeError[39m                                 Traceback (most recent call last)
[36mCell[39m[36m [39m[32mIn[13][39m[32m, line 5[39m
[32m      2[39m [38;5;250m    [39m[33;03m"""Input schema for checking course prerequisites."""[39;00m
[32m      3[39m     course_id: [38;5;28mstr[39m = Field(description=[33m"[39m[33mThe course ID to check prerequisites for (e.g., [39m[33m'[39m[33mRU202[39m[33m'[39m[33m)[39m[33m"[39m)
[32m----> [39m[32m5[39m [38;5;129m@tool[39m[43m([49m[33;43m"[39;49m[33;43mcheck_prerequisites[39;49m[33;43m"[39;49m[43m,[49m[43m [49m[43margs_schema[49m[43m=[49m[43mCheckPrerequisitesInput[49m[43m)[49m
[32m      6[39m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m[38;5;250m [39m[34mcheck_prerequisites[39m(course_id: [38;5;28mstr[39m) -> [38;5;28mstr[39m:
[32m      7[39m [38;5;250m    [39m[33;03m"""[39;00m
[32m      8[39m [33;03m    Check the prerequisites for a specific course.[39;00m
[32m      9[39m 
[32m   (...)[39m[32m     16[39m [33;03m    Returns: List of prerequisite courses and recommended background knowledge.[39;00m
[32m     17[39m [33;03m    """[39;00m
[32m     18[39m     [38;5;66;03m# Simulated prerequisite data (in production, this would query a database)[39;00m

[36mFile [39m[32m~/.pyenv/versions/3.12.6/lib/python3.12/site-packages/langchain_core/_api/deprecation.py:193[39m, in [36mdeprecated.<locals>.deprecate.<locals>.warning_emitting_wrapper[39m[34m(*args, **kwargs)[39m
[32m    191[39m     warned = [38;5;28;01mTrue[39;00m
[32m    192[39m     emit_warning()
[32m--> [39m[32m193[39m [38;5;28;01mreturn[39;00m [43mwrapped[49m[43m([49m[43m*[49m[43margs[49m[43m,[49m[43m [49m[43m*[49m[43m*[49m[43mkwargs[49m[43m)[49m

[31mTypeError[39m: BaseTool.__call__() got an unexpected keyword argument 'args_schema'



================================================================================
Executing: 03_production_readiness_quality_assurance.ipynb
================================================================================
Executing notebook...
‚úÖ Saved executed notebook with outputs

================================================================================
EXECUTION SUMMARY
================================================================================
‚úÖ 03_memory_management_long_conversations.ipynb: SUCCESS
‚ùå 01_measuring_optimizing_performance.ipynb: FAILED
‚ùå 02_scaling_semantic_tool_selection.ipynb: FAILED
‚úÖ 03_production_readiness_quality_assurance.ipynb: SUCCESS

‚ö†Ô∏è  Some notebooks failed to execute
